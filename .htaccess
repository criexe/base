RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^(.+)$ index.php?cxURL=$1 [QSA,L]

RewriteBase /
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

RewriteBase /
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

# Dont List
Options -Indexes

# Error Pages
ErrorDocument 403 /pages/403.php
ErrorDocument 404 /pages/404.php
ErrorDocument 500 /pages/500.php

#<FilesMatch "\.css$">
#  SetHandler application/x-httpd-php
#  Header set Content-type "text/css"
#</FilesMatch>
#
#<FilesMatch "\.js$">
#  SetHandler application/x-httpd-php
#  Header set Content-type "text/javascript"
#</FilesMatch>

AddType    application/x-httpd-php .php .html .htm .cx
AddHandler application/x-httpd-php .php .html .htm .cx

<filesMatch ".(css|jpg|jpeg|png|gif|js|ico|woff2|woff)$">
    Header set Cache-Control "max-age=2628000, public"
</filesMatch>

<IfModule mod_deflate.c>
    <IfModule mod_filter.c>
        AddOutputFilterByType DEFLATE text/html text/plain text/xml
        AddOutputFilterByType DEFLATE text/css
        AddOutputFilterByType DEFLATE application/x-javascript application/javascript application/ecmascript
        AddOutputFilterByType DEFLATE application/rss+xml
        AddOutputFilterByType DEFLATE application/xml
    </IfModule>
</IfModule>

<ifModule mod_gzip.c>
    mod_gzip_on Yes
    mod_gzip_dechunk Yes
    mod_gzip_item_include file .(html?|txt|css|js|php|pl)$
    mod_gzip_item_include handler ^cgi-script$
    mod_gzip_item_include mime ^text/.*
    mod_gzip_item_include mime ^application/x-javascript.*
    mod_gzip_item_exclude mime ^image/.*
    mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</ifModule>

# Google PageSpeed Module
<IfModule pagespeed_module>
    ModPagespeed on
    ModPagespeedDisallow "*.amp"
    ModPagespeedEnableFilters remove_comments
    ModPagespeedEnableFilters make_google_analytics_async
    ModPagespeedEnableFilters make_show_ads_async
    ModPagespeedEnableFilters rewrite_javascript
    ModPagespeedEnableFilters rewrite_css
    ModPagespeedEnableFilters rewrite_style_attributes
    ModPagespeedEnableFilters sprite_images
    ModPagespeedEnableFilters extend_cache
    ModPagespeedEnableFilters extend_cache_pdfs
#    ModPagespeedEnableFilters remove_quotes
    ModPagespeedEnableFilters responsive_images,resize_images
    ModPagespeedEnableFilters responsive_images_zoom
    ModPagespeedEnableFilters local_storage_cache
    ModPagespeedEnableFilters convert_meta_tags
    ModPagespeedEnableFilters combine_heads
    ModPagespeedEnableFilters collapse_whitespace
    ModPagespeedEnableFilters elide_attributes
    ModPagespeedEnableFilters insert_dns_prefetch
    ModPagespeedEnableFilters trim_urls
    ModPagespeedEnableFilters rewrite_domains
    ModPagespeedDomainRewriteHyperlinks on
    ModPagespeedEnableFilters combine_javascript
    ModPagespeedCombineAcrossPaths on
</IfModule>

<IfModule mod_headers.c>
  Header set X-XSS-Protection "1; mode=block"
</IfModule>

